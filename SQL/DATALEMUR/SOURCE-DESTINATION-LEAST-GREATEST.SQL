WITH CTE AS(
    SELECT
        LEAST(SOURCE, DESTINATION) AS SOURCE,
        GREATEST(SOURCE, DESTINATION) AS DESTINATION,
        DISTANCE,
        ROW_NUMBER() OVER(
            PARTITION BY LEAST(SOURCE, DESTINATION),
            GREATEST(SOURCE, DESTINATION),
            DISTANCE
            ORDER BY
                DISTANCE
        ) AS RNK
    FROM
        CITY_DISTANCE
)
SELECT
    SOURCE,
    DESTINATION,
    DISTANCE
FROM
    CTE
WHERE
    RNK = 1
ORDER BY
    SOURCE,
    DESTINATION,
    DISTANCE DESC