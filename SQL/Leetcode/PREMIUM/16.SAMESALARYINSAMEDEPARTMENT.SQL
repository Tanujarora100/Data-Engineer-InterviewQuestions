WITH CTE AS(
    SELECT
        *,
        COUNT(1) OVER(PARTITION BY DEPT_ID, SALARY) AS TOTAL_SAME_SALARY
    FROM
        EMP_SALARY
) -- WHOSE SALARY IS SAME
SELECT
    EMP_ID,
    NAME,
    DEPT_ID AS DEPARTMENT,
    SALARY
FROM
    CTE
WHERE
    TOTAL_SAME_SALARY > 1 -- WHOSE SALARY IS UNIQUE
SELECT
    EMP_ID,
    NAME,
    DEPT_ID AS DEPARTMENT,
    SALARY
FROM
    CTE
WHERE
    TOTAL_SAME_SALARY = 1